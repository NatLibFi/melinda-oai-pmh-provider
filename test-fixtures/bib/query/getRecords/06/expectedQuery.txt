SELECT /*+ ORDERED */ id, time FROM (
					SELECT z106_rec_key id, MAX(RPAD(CONCAT(z106_update_date, LPAD(z106_time, 4, '0')), 12, '0')) time FROM foo01.z106
						
						WHERE
						(z106_update_date = :startDate AND z106_time >= :startTime) OR (z106_update_date = :endDate AND z106_time <= :endTime) OR (z106_update_date > :startDate AND z106_update_date < :endDate)
					GROUP BY z106_rec_key
						OFFSET 0 ROWS FETCH NEXT 1000 ROWS ONLY
				)
				
				